<!DOCTYPE html><html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>A Simple Web Scraper in Go | Gregory Schier</title><script>if (window.location.host.indexOf('localhost') !== 0) {
            !function(){var analytics=window.analytics=window.analytics||[];if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","group","track","ready","alias","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t){var e=document.createElement("script");e.type="text/javascript";e.async=!0;e.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)};analytics.SNIPPET_VERSION="3.0.0";
                analytics.load('psilXaJonhdBrrQRzFErc9VRNDIBR3FT');
                analytics.page()
            }}();
        }</script><script src="https://carnivalapp.io/sites/174/init.js"></script><script>document.addEventListener("DOMContentLoaded", Carnival.init);</script><link rel="alternate" type="application/rss+xml" title="Gregory Schier Blog" href="/rss.xml"><link rel="stylesheet" href="/styles/bootstrap.min.css"><link rel="stylesheet" href="/styles/main.css"><link rel="stylesheet" href="/styles/main.css"><link rel="stylesheet" href="/styles/monokai.css"><link href="//fonts.googleapis.com/css?family=Raleway:200,100,400" rel="stylesheet" type="text/css"><link href="//fonts.googleapis.com/css?family=Open+Sans:400italic,400,300" rel="stylesheet" type="text/css"><link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet"><link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png"><link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png"><link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png"><link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png"><link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png"><link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png"><link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png"><link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png"><link rel="icon" type="image/png" href="/favicon-192x192.png" sizes="192x192"><link rel="icon" type="image/png" href="/favicon-160x160.png" sizes="160x160"><link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96"><link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16"><link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-TileImage" content="/mstile-144x144.png"><style>nav a, nav a:hover, header { color:#FFF; }
            #icon-path { fill: #FFF !important; }</style></head><body><div id="wrapper"><div id="main-content"><nav style="color:#FFF"><span class="social pull-right"><a href="https://twitter.com/gregoryschier" title="Gregory Schier Twitter" style="" target="_blank"><i class="fa fa-twitter-square"></i></a> <a href="https://plus.google.com/102509209246537377732?rel=author" title="Gregory Schier Google Plus" style="" target="_blank"><i class="fa fa-google-plus-square"></i></a> <a href="http://www.linkedin.com/profile/view?id=180332858" title="Gregory Schier LinkedIn" style="" target="_blank"><i class="fa fa-linkedin-square"></i></a> <a href="https://github.com/gschier" title="Gregory Schier Github" style="" target="_blank"><i class="fa fa-github-square"></i></a> <a href="/rss.xml" title="Gregory Schier RSS" style="" target="_blank"><i class="fa fa-rss-square"></i></a></span> <a href="/"><svg version="1.1" class="logo" viewbox="0 0 102 102"><g transform="translate(0,-952.36218)"><g transform="matrix(0.92799441,0,0,0.92799159,-294.93182,419.81087)"><path d="m 364.14179,607.98027 c -0.19851,-0.31252 -3.88299,-6.67648 -8.18773,-14.14214 l -7.82681,-13.57392 25.83362,0 25.83362,0 8.10719,14.03754 c 4.45895,7.72064 8.10718,14.08461 8.10718,14.14213 0,0.0575 -11.58888,0.1046 -25.75307,0.1046 l -25.75307,0 -0.36093,-0.56821 z m -30.34535,47.48125 c -5.39384,-9.343 -11.19592,-19.3925 -12.89352,-22.33222 l -3.08654,-5.34495 12.88011,-22.30798 c 7.08407,-12.26938 12.90068,-22.32946 12.92581,-22.35572 0.0767,-0.0801 15.9387,27.48044 16.02316,27.84058 0.0434,0.18498 -2.03801,4.00166 -4.62532,8.48151 -2.5873,4.47986 -4.6569,8.32177 -4.5991,8.53759 0.0578,0.21581 2.1676,3.95462 4.68845,8.30845 2.52085,4.35383 4.58337,8.02832 4.58337,8.16553 0,0.21998 -15.00709,26.41175 -15.78443,27.54846 -0.26345,0.38524 -1.64141,-1.86883 -10.11199,-16.54125 z m 14.57389,19.51802 c 0.0465,-0.13277 3.66431,-6.43983 8.03953,-14.0157 l 7.95495,-13.77431 9.63495,-10e-4 9.63495,-10e-4 4.60818,-8.01808 c 2.53451,-4.40995 4.73811,-8.16099 4.8969,-8.33565 0.22732,-0.25002 3.70715,-0.30373 16.36229,-0.25254 l 16.07357,0.065 -12.83685,22.22336 -12.83685,22.22336 -25.8081,0.0643 c -16.33075,0.0407 -25.77704,-0.0243 -25.72352,-0.17707 z" id="icon-path" style="fill:#fff;fill-opacity:1;stroke:none"></g></g></svg></a><div class="breadcrumbs"><a href="/blog/">Blog</a></div></nav><div class="header-wrapper page-type-blog_post" style="background-image: url('/images/gopher.jpg')"><div class="container"><header style="padding: 8em 0 9em 0"><h1>A Simple Web Scraper in Go</h1><div class="meta" style="color:#FFF"><time datetime="April 26, 2015" title="April 26, 2015">April 26, 2015</time><div class="author">Gregory Schier</div></div></header></div></div><div class="container page-body"><div class="row"><div class="col-sm-12"><article><section><p>In my day job at <a href="https://www.sendwithus.com">Sendwithus</a>, we&#39;ve been having trouble writing performant concurrent systems in Python. We&#39;ve come to the conclusion that Python just isn&#39;t suitable for some of our high throughput tasks, so we&#39;ve started playing around with <a href="https://golang.org/">Go</a> as a potential replacement.</p><p>After making it all the way through the <a href="http://tour.golang.org">Golang Interactive Tour</a>, which I highly recommend doing if you haven&#39;t yet, I wanted to build something real. The last task in the Go tour is to build a concurrent web crawler, but it faked the fun parts like making HTTP requests and parsing HTML. It was this that motivated me to close the tutorial and write a real web scraper. This post is going to show you how to build it.</p><p>There are three main things that we&#39;ll be covering:</p><ul><li>using the <code>net/http</code> package to fetch a web page</li><li>using the <code>golang.org/x/net/html</code> to parse an HTML document</li><li>using Go concurrency with multi-channel communication</li></ul><p>In order to keep this tutorial from being too long, I won&#39;t be accommodating those of you that haven&#39;t yet made it through the <a href="http://tour.golang.org">Go Tour</a>. The tour should teach you everything you need to know to follow along.</p><h2 id="what-we-ll-be-building">What We&#39;ll Be Building</h2><p>As I mentioned in the introduction, we&#39;ll be going over how to build a simple web scraper in Go. Note that I didn&#39;t say <em>web crawler</em> because our scraper will only be going one level deep (maybe I&#39;ll cover crawling in another post).</p><p>To give you a brief description, we&#39;re going to be building a basic command line tool that takes a list of starting URLs as input and prints all the links that it finds on those pages.</p><p>Here&#39;s an example of it in action:</p><pre><code class="lang-text"><div class="highlight"><pre>$ go run main.go http://schier.co https://google.com                  

Found 18 unique urls:

 - https://plus.google.com/102509209246537377732?rel=author
 - http://www.linkedin.com/profile/view?id=180332858
 - https://github.com/gschier
 - https://www.sendwithus.com
 - https://twitter.com/gregoryschier
 ...
</pre></div>

</code></pre><p>Now that you know what we&#39;re building, let&#39;s get to the fun part.</p><h2 id="breaking-it-down">Breaking it Down</h2><p>To make this tutorial easier to digest, I&#39;ll be breaking it down isolated components. After going over each component, I&#39;ll put them all together to form the final product. The first component we&#39;ll be going over is making an HTTP request to fetch some HTML.</p><h3 id="fetching-a-web-page-by-url">Fetching a Web Page by URL</h3><p>Making HTTP requests in Go is easy. The <a href="http://golang.org/pkg/net/http/">http</a> package provides a simple way of doing this in just a couple lines of code.</p><p><em>Note that things like error handling are omitted to keep this example short.</em></p><pre><code class="lang-go"><div class="highlight"><pre><span class="c1">//~~~~~~~~~~~~~~~~~~~~~~//</span>
<span class="c1">// Make an HTTP request //</span>
<span class="c1">//~~~~~~~~~~~~~~~~~~~~~~//</span>

<span class="nx">resp</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">http</span><span class="p">.</span><span class="nx">Get</span><span class="p">(</span><span class="nx">url</span><span class="p">)</span>
<span class="nx">bytes</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">ioutil</span><span class="p">.</span><span class="nx">ReadAll</span><span class="p">(</span><span class="nx">resp</span><span class="p">.</span><span class="nx">Body</span><span class="p">)</span>

<span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;HTML:\n\n&quot;</span><span class="p">,</span> <span class="nb">string</span><span class="p">(</span><span class="nx">bytes</span><span class="p">))</span>

<span class="nx">resp</span><span class="p">.</span><span class="nx">Body</span><span class="p">.</span><span class="nx">Close</span><span class="p">()</span>
</pre></div>

</code></pre><p>Making an HTTP request is the foundation of our web scraper. Now that we know how to do that, we can dig into parsing the HTML to extract links.</p><h3 id="finding-links-in-html">Finding Links in HTML</h3><p>Go doesn&#39;t have a core package for parsing HTML, but there is a package provided in the <a href="https://code.google.com/p/go-wiki/wiki/SubRepositories">Golang SubRepositores</a> that we can use by importing <code>golang.org/x/net/html</code>.</p><p>If you&#39;ve never interacted with an XML or HTML tokenizer before, this may take some time to grasp, but it&#39;s really not that difficult. The tokenizer splits the HTML document into tokens that can be iterated over. Here are the possible things that a token can represent (<a href="https://godoc.org/golang.org/x/net/html#TokenType">documentation</a>):</p><table><thead><tr><th style="text-align:left">Token Name</th><th style="text-align:left">Token Description</th></tr></thead><tbody><tr><td style="text-align:left"><code>ErrorToken</code></td><td style="text-align:left">error during tokenization (or end of document)</td></tr><tr><td style="text-align:left"><code>TextToken</code></td><td style="text-align:left">text node (contents of an element)</td></tr><tr><td style="text-align:left"><code>StartTagToken</code></td><td style="text-align:left">example <code>&lt;a&gt;</code></td></tr><tr><td style="text-align:left"><code>EndTagToken</code></td><td style="text-align:left">example <code>&lt;/a&gt;</code></td></tr><tr><td style="text-align:left"><code>SelfClosingTagToken</code></td><td style="text-align:left">example <code>&lt;br/&gt;</code></td></tr><tr><td style="text-align:left"><code>CommentToken</code></td><td style="text-align:left">example <code>&lt;!-- Hello World --&gt;</code></td></tr><tr><td style="text-align:left"><code>DoctypeToken</code></td><td style="text-align:left">example <code>&lt;!DOCTYPE html&gt;</code></td></tr></tbody></table><p>For our case, we are looking for URLs, which will be found inside opening <code>&lt;a&gt;</code> tags. The code below demonstrates how to find all the opening anchor tags in an HTML document.</p><pre><code class="lang-go"><div class="highlight"><pre><span class="c1">//~~~~~~~~~~~~~~~~~~~~~~~~~~~~//</span>
<span class="c1">// Parse HTML for Anchor Tags //</span>
<span class="c1">//~~~~~~~~~~~~~~~~~~~~~~~~~~~~//</span>

<span class="nx">z</span> <span class="o">:=</span> <span class="nx">html</span><span class="p">.</span><span class="nx">NewTokenizer</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">Body</span><span class="p">)</span>

<span class="k">for</span> <span class="p">{</span>
    <span class="nx">tt</span> <span class="o">:=</span> <span class="nx">z</span><span class="p">.</span><span class="nx">Next</span><span class="p">()</span>

    <span class="k">switch</span> <span class="p">{</span>
    <span class="k">case</span> <span class="nx">tt</span> <span class="o">==</span> <span class="nx">html</span><span class="p">.</span><span class="nx">ErrorToken</span><span class="p">:</span>
        <span class="c1">// End of the document, we&#39;re done</span>
        <span class="k">return</span>
    <span class="k">case</span> <span class="nx">tt</span> <span class="o">==</span> <span class="nx">html</span><span class="p">.</span><span class="nx">StartTagToken</span><span class="p">:</span>
        <span class="nx">t</span> <span class="o">:=</span> <span class="nx">z</span><span class="p">.</span><span class="nx">Token</span><span class="p">()</span>

        <span class="nx">isAnchor</span> <span class="o">:=</span> <span class="nx">t</span><span class="p">.</span><span class="nx">Data</span> <span class="o">==</span> <span class="s">&quot;a&quot;</span>
        <span class="k">if</span> <span class="nx">isAnchor</span> <span class="p">{</span>
            <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;We found a link!&quot;</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

</code></pre><p>Now that we have found the anchor tags, how do we get the <code>href</code> value? Unfortunately, it&#39;s not as easy as you would expect. A token stores it&#39;s attributes in an array, so the only way to get the <code>href</code> is to iterate over every attribute until we find it. Here&#39;s the code to do it.</p><pre><code class="lang-go"><div class="highlight"><pre><span class="c1">//~~~~~~~~~~~~~~~~~~~//</span>
<span class="c1">// Get Tag Attribute //</span>
<span class="c1">//~~~~~~~~~~~~~~~~~~~//</span>

<span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">a</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">t</span><span class="p">.</span><span class="nx">Attr</span> <span class="p">{</span>
    <span class="k">if</span> <span class="nx">a</span><span class="p">.</span><span class="nx">Key</span> <span class="o">==</span> <span class="s">&quot;href&quot;</span> <span class="p">{</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;Found href:&quot;</span><span class="p">,</span> <span class="nx">a</span><span class="p">.</span><span class="nx">Val</span><span class="p">)</span>
        <span class="k">break</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

</code></pre><p>At this point we know how to fetch HTML using an HTTP request, as well as extract the links from that HTML document. So what&#39;s next? Well, we need to put it all together.</p><p>In order to make our scraper performant, and to make this tutorial a bit more advanced, we&#39;ll be making use of goroutines and channels.</p><h3 id="goroutines-with-multiple-channels">Goroutines with Multiple Channels</h3><p>Possibly the trickiest part of this scraper is how it uses channels. In order for the scraper to run quickly, it needs to fetch all URLs concurrently. If concurrency is used, total execution time should equal the time taken to fetch the slowest request. Without concurrency (synchronous requests), execution time would equal the sum of all request times (BAD!). So how do we do this?</p><p>The approach I&#39;ve taken is to kick off one goroutine per request, having each goroutine publish the URLs it finds to a shared channel. There&#39;s one problem with this though. How do we know when to close the channel? We need some way of knowing when the last URL has been published. We can use a second channel for this.</p><p>The second channel is simply a notification channel. After a goroutine has published all of it&#39;s URLs into the main channel, it publishes a <em>done</em> message to the notification channel. The main thread subscribes to the notification channel and closes the program after all goroutines have notified that they are finished. This will make much more sense when you see the finished code.</p><h2 id="putting-it-all-together">Putting it All Together</h2><p>If you&#39;ve made it this far, you should know everything you need in order to comprehend the full program. I&#39;ve also added a few comments to help explain some of the more complicated parts.</p><pre><code class="lang-go"><div class="highlight"><pre><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s">&quot;fmt&quot;</span>
    <span class="s">&quot;golang.org/x/net/html&quot;</span>
    <span class="s">&quot;net/http&quot;</span>
    <span class="s">&quot;os&quot;</span>
    <span class="s">&quot;strings&quot;</span>
<span class="p">)</span>

<span class="c1">// Helper function to pull the href attribute from a Token</span>
<span class="kd">func</span> <span class="nx">getHref</span><span class="p">(</span><span class="nx">t</span> <span class="nx">html</span><span class="p">.</span><span class="nx">Token</span><span class="p">)</span> <span class="p">(</span><span class="nx">ok</span> <span class="kt">bool</span><span class="p">,</span> <span class="nx">href</span> <span class="kt">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Iterate over all of the Token&#39;s attributes until we find an &quot;href&quot;</span>
    <span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">a</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">t</span><span class="p">.</span><span class="nx">Attr</span> <span class="p">{</span>
        <span class="k">if</span> <span class="nx">a</span><span class="p">.</span><span class="nx">Key</span> <span class="o">==</span> <span class="s">&quot;href&quot;</span> <span class="p">{</span>
            <span class="nx">href</span> <span class="p">=</span> <span class="nx">a</span><span class="p">.</span><span class="nx">Val</span>
            <span class="nx">ok</span> <span class="p">=</span> <span class="kc">true</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// &quot;bare&quot; return will return the variables (ok, href) as defined in</span>
    <span class="c1">// the function definition</span>
    <span class="k">return</span>
<span class="p">}</span>

<span class="c1">// Extract all http** links from a given webpage</span>
<span class="kd">func</span> <span class="nx">crawl</span><span class="p">(</span><span class="nx">url</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">ch</span> <span class="kd">chan</span> <span class="kt">string</span><span class="p">,</span> <span class="nx">chFinished</span> <span class="kd">chan</span> <span class="kt">bool</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">resp</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">http</span><span class="p">.</span><span class="nx">Get</span><span class="p">(</span><span class="nx">url</span><span class="p">)</span>

    <span class="k">defer</span> <span class="kd">func</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// Notify that we&#39;re done after this function</span>
        <span class="nx">chFinished</span> <span class="o">&lt;-</span> <span class="kc">true</span>
    <span class="p">}()</span>

    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;ERROR: Failed to crawl \&quot;&quot;</span> <span class="o">+</span> <span class="nx">url</span> <span class="o">+</span> <span class="s">&quot;\&quot;&quot;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="p">}</span>

    <span class="nx">b</span> <span class="o">:=</span> <span class="nx">resp</span><span class="p">.</span><span class="nx">Body</span>
    <span class="k">defer</span> <span class="nx">b</span><span class="p">.</span><span class="nx">Close</span><span class="p">()</span> <span class="c1">// close Body when the function returns</span>

    <span class="nx">z</span> <span class="o">:=</span> <span class="nx">html</span><span class="p">.</span><span class="nx">NewTokenizer</span><span class="p">(</span><span class="nx">b</span><span class="p">)</span>

    <span class="k">for</span> <span class="p">{</span>
        <span class="nx">tt</span> <span class="o">:=</span> <span class="nx">z</span><span class="p">.</span><span class="nx">Next</span><span class="p">()</span>

        <span class="k">switch</span> <span class="p">{</span>
        <span class="k">case</span> <span class="nx">tt</span> <span class="o">==</span> <span class="nx">html</span><span class="p">.</span><span class="nx">ErrorToken</span><span class="p">:</span>
            <span class="c1">// End of the document, we&#39;re done</span>
            <span class="k">return</span>
        <span class="k">case</span> <span class="nx">tt</span> <span class="o">==</span> <span class="nx">html</span><span class="p">.</span><span class="nx">StartTagToken</span><span class="p">:</span>
            <span class="nx">t</span> <span class="o">:=</span> <span class="nx">z</span><span class="p">.</span><span class="nx">Token</span><span class="p">()</span>

            <span class="c1">// Check if the token is an &lt;a&gt; tag</span>
            <span class="nx">isAnchor</span> <span class="o">:=</span> <span class="nx">t</span><span class="p">.</span><span class="nx">Data</span> <span class="o">==</span> <span class="s">&quot;a&quot;</span>
            <span class="k">if</span> <span class="p">!</span><span class="nx">isAnchor</span> <span class="p">{</span>
                <span class="k">continue</span>
            <span class="p">}</span>

            <span class="c1">// Extract the href value, if there is one</span>
            <span class="nx">ok</span><span class="p">,</span> <span class="nx">url</span> <span class="o">:=</span> <span class="nx">getHref</span><span class="p">(</span><span class="nx">t</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">!</span><span class="nx">ok</span> <span class="p">{</span>
                <span class="k">continue</span>
            <span class="p">}</span>

            <span class="c1">// Make sure the url begines in http**</span>
            <span class="nx">hasProto</span> <span class="o">:=</span> <span class="nx">strings</span><span class="p">.</span><span class="nx">Index</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="s">&quot;http&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="nx">hasProto</span> <span class="p">{</span>
                <span class="nx">ch</span> <span class="o">&lt;-</span> <span class="nx">url</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">foundUrls</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">bool</span><span class="p">)</span>
    <span class="nx">seedUrls</span> <span class="o">:=</span> <span class="nx">os</span><span class="p">.</span><span class="nx">Args</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

    <span class="c1">// Channels</span>
    <span class="nx">chUrls</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="kd">chan</span> <span class="kt">string</span><span class="p">)</span>
    <span class="nx">chFinished</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="kd">chan</span> <span class="kt">bool</span><span class="p">)</span> 

    <span class="c1">// Kick off the crawl process (concurrently)</span>
    <span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">url</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">seedUrls</span> <span class="p">{</span>
        <span class="k">go</span> <span class="nx">crawl</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">chUrls</span><span class="p">,</span> <span class="nx">chFinished</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="c1">// Subscribe to both channels</span>
    <span class="k">for</span> <span class="nx">c</span> <span class="o">:=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">c</span> <span class="p">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="nx">seedUrls</span><span class="p">);</span> <span class="p">{</span>
        <span class="k">select</span> <span class="p">{</span>
        <span class="k">case</span> <span class="nx">url</span> <span class="o">:=</span> <span class="o">&lt;-</span><span class="nx">chUrls</span><span class="p">:</span>
            <span class="nx">foundUrls</span><span class="p">[</span><span class="nx">url</span><span class="p">]</span> <span class="p">=</span> <span class="kc">true</span>
        <span class="k">case</span> <span class="o">&lt;-</span><span class="nx">chFinished</span><span class="p">:</span>
            <span class="nx">c</span><span class="o">++</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// We&#39;re done! Print the results...</span>

    <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot;\nFound&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="nx">foundUrls</span><span class="p">),</span> <span class="s">&quot;unique urls:\n&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="nx">url</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">foundUrls</span> <span class="p">{</span>
        <span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&quot; - &quot;</span> <span class="o">+</span> <span class="nx">url</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="nb">close</span><span class="p">(</span><span class="nx">chUrls</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>

</code></pre><h2 id="wrap-up">Wrap Up</h2><p>That wraps up the tutorial of a Go web scraper CLI. We&#39;ve covered making HTTP requests, parsing HTML, and even some slightly complicated concurrency patterns.</p><p>I hope it was simple enough for you to follow along and maybe even learn a few things. I&#39;ll probably be doing a few more of these posts as I learn more about Go so make sure you subscribe, either via email (bottom of page) or <a href="http://schier.co/rss.xml">RSS</a>.</p><p>As always, thanks for reading! :)</p></section><footer><div class="text-center"><h4 class="spaced">Share this Post <i class="fa fa-smile-o"></i></h4><span class="social-sharing"><a href="http://twitter.com/share?url=http%3A%2F%2Fschier.co%2Fblog%2F2015%2F04%2F26%2Fa-simple-web-scraper-in-go.html&text=A%20Simple%20Web%20Scraper%20in%20Go&via=GregorySchier" title="Share on Twitter" target="_blank" class="btn bg-twitter"><i class="fa fa-twitter"></i></a> <a href="http://reddit.com/submit?url=http%3A%2F%2Fschier.co%2Fblog%2F2015%2F04%2F26%2Fa-simple-web-scraper-in-go.html&title=A%20Simple%20Web%20Scraper%20in%20Go" title="Share on Reddit" target="_blank" class="btn bg-reddit"><i class="fa fa-reddit"></i></a> <a href="https://plus.google.com/share?url=http%3A%2F%2Fschier.co%2Fblog%2F2015%2F04%2F26%2Fa-simple-web-scraper-in-go.html" title="Share on Google Plus" target="_blank" class="btn bg-google-plus"><i class="fa fa-google-plus"></i></a> <a href="http://www.linkedin.com/shareArticle?url=http%3A%2F%2Fschier.co%2Fblog%2F2015%2F04%2F26%2Fa-simple-web-scraper-in-go.html&title=A%20Simple%20Web%20Scraper%20in%20Go" title="Share on LinkedIn" target="_blank" class="btn bg-linkedin"><i class="fa fa-linkedin"></i></a> <a href="http://www.stumbleupon.com/submit?url=http%3A%2F%2Fschier.co%2Fblog%2F2015%2F04%2F26%2Fa-simple-web-scraper-in-go.html&title=A%20Simple%20Web%20Scraper%20in%20Go" title="Share on StumbleUpon" target="_blank" class="btn bg-stumbleupon"><i class="fa fa-stumbleupon"></i></a> <a href="http://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fschier.co%2Fblog%2F2015%2F04%2F26%2Fa-simple-web-scraper-in-go.html" title="Share on Facebook" target="_blank" class="btn bg-facebook"><i class="fa fa-facebook"></i></a> <a href="mailto:?subject=A%20Simple%20Web%20Scraper%20in%20Go&body=http%3A%2F%2Fschier.co%2Fblog%2F2015%2F04%2F26%2Fa-simple-web-scraper-in-go.html" title="Share by Email" target="_blank" class="btn bg-email"><i class="fa fa-envelope"></i></a></span></div><hr><div class="row"><div class="col-sm-4"><p><img src="http:/images/me.jpg" class="round me" alt="Gregory Schier"></p></div><div class="col-sm-8"><h1>Written by Gregory Schier</h1><p>I'm a software engineer living in Victoria BC, Canada. I love building things. I am currently the Lead Engineer at <a href="https://www.sendwithus.com">sendwithus</a>. <i class="fa fa-laptop"></i></p><span class="social"><a href="https://twitter.com/gregoryschier" title="Gregory Schier Twitter" style="" target="_blank"><i class="fa fa-twitter-square"></i></a> <a href="https://plus.google.com/102509209246537377732?rel=author" title="Gregory Schier Google Plus" style="" target="_blank"><i class="fa fa-google-plus-square"></i></a> <a href="http://www.linkedin.com/profile/view?id=180332858" title="Gregory Schier LinkedIn" style="" target="_blank"><i class="fa fa-linkedin-square"></i></a> <a href="https://github.com/gschier" title="Gregory Schier Github" style="" target="_blank"><i class="fa fa-github-square"></i></a> <a href="/rss.xml" title="Gregory Schier RSS" style="" target="_blank"><i class="fa fa-rss-square"></i></a></span></div></div></footer></article></div></div></div><div class="container"><div class="row"><div class="col-md-12"><hr><a href="/blog" class="pull-right">View All Posts</a><h2>Popular Blog Posts</h2></div></div><div class="row spaced"><div class="col-sm-4"><a href="/blog/2014/10/22/pure-html-share-buttons.html" title="Pretty HTML Share Buttons" class="no-under"><div class="spaced img-header" style="background-image: url('/images/thumbs/graph.jpg')"></div><h3>Pretty HTML Share Buttons</h3><p class="small">Share buttons are a great way to drive more traffic to a website. Unfortunately, most share buttons social networks provide are ugly...</p><p class="small">Read More <i class="fa fa-arrow-circle-o-right"></i></p></a></div><div class="col-sm-4"><a href="/blog/2013/11/14/method-chaining-in-javascript.html" title="Method Chaining in JavaScript" class="no-under"><div class="spaced img-header" style="background-image: url('/images/thumbs/chain.jpg')"></div><h3>Method Chaining in JavaScript</h3><p class="small">Method chaining is a common pattern in the JavaScript world. This tutorial will provide a brief explanation of what method chaining is...</p><p class="small">Read More <i class="fa fa-arrow-circle-o-right"></i></p></a></div><div class="col-sm-4"><a href="/blog/2013/11/16/creating-pure-css-lightboxes-with-the-target-selector.html" title="Pure CSS Lightboxes With :target" class="no-under"><div class="spaced img-header" style="background-image: url('/images/thumbs/pig.jpg')"></div><h3>Pure CSS Lightboxes With :target</h3><p class="small">This tutorial will show you how to create a JavaScript-free lightbox using CSS only. To accomplish this, we will make use of the :target selector...</p><p class="small">Read More <i class="fa fa-arrow-circle-o-right"></i></p></a></div></div><div class="row spaced"><div class="col-sm-4"><a href="/blog/2014/10/23/creating-a-pure-css-dropdown-using-the-hover-selector.html" title="CSS Dropdown Using :hover" class="no-under"><div class="spaced img-header" style="background-image: url('/images/thumbs/code.jpg')"></div><h3>CSS Dropdown Using :hover</h3><p class="small">In this tutorial we're going to be building a basic dropdown button. Here's a peak at what the final result will look like. Let's get started...</p><p class="small">Read More <i class="fa fa-arrow-circle-o-right"></i></p></a></div><div class="col-sm-4"><a href="/blog/2014/03/01/clicky-3d-buttons-with-css.html" title="Clicky 3D Buttons with CSS" class="no-under"><div class="spaced img-header" style="background-image: url('/images/thumbs/mouse.jpg')"></div><h3>"Clicky" 3D Buttons with CSS</h3><p class="small">There are two main components to creating these buttons. The first component is creating the bottom edge, and the second component is...</p><p class="small">Read More <i class="fa fa-arrow-circle-o-right"></i></p></a></div><div class="col-sm-4"><a href="/blog/2013/11/09/how-to-root-nexus-5-in-linux.html" title="How to Root Nexus 5 in Linux" class="no-under"><div class="spaced img-header" style="background-image: url('/images/thumbs/nexus.jpg')"></div><h3>How to Root Nexus 5 in Linux</h3><p class="small">I just bought a Nexus 5 today and wanted to root it. I tried running the following script without success. I kept getting the following error...</p><p class="small">Read More <i class="fa fa-arrow-circle-o-right"></i></p></a></div></div><div class="row"><div class="col-sm-12"><p class="small">Check out more of my posts by visiting my <a href="/blog">Blog Archive</a>.</p></div></div><div class="row"><div class="small text-center col-sm-12"><hr><p><form id="registration-form"><input type="email" class="form-control" id="registration-email" placeholder="me@domain.com" required><button type="submit" id="registration-button">Keep Me Posted!</button></form>© 2014, Gregory Schier<br><a href="/rss.xml">rss feed</a></p></div></div></div></div></div><script src="/scripts/main.js"></script></body></html>